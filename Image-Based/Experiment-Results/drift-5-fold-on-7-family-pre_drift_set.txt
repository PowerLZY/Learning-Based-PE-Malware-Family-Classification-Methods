Label: 0        Family:         bifrose Number of images: 171
Label: 1        Family:       ceeinject Number of images: 90
Label: 2        Family:      obfuscator Number of images: 143
Label: 3        Family:        vbinject Number of images: 378
Label: 4        Family:          vobfus Number of images: 64
Label: 5        Family:       winwebsec Number of images: 218
Label: 6        Family:          zegost Number of images: 180
Processing images ...
Images processed: 1244
2021-04-08 12:01:30.195673: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-04-08 12:01:30.303715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties:
pciBusID: 0000:1a:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-04-08 12:01:30.303764: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-04-08 12:01:30.305529: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-04-08 12:01:30.306796: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-04-08 12:01:30.307117: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-04-08 12:01:30.308787: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-04-08 12:01:30.309962: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-04-08 12:01:30.313572: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-04-08 12:01:30.316395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-04-08 12:01:30.316792: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-08 12:01:30.331561: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2300000000 Hz
2021-04-08 12:01:30.336050: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x542a740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-04-08 12:01:30.336080: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-04-08 12:01:30.498516: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5345920 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-08 12:01:30.498578: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2021-04-08 12:01:30.501680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties:
pciBusID: 0000:1a:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-04-08 12:01:30.501755: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-04-08 12:01:30.501798: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-04-08 12:01:30.501826: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-04-08 12:01:30.501862: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-04-08 12:01:30.501894: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-04-08 12:01:30.501924: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-04-08 12:01:30.501954: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-04-08 12:01:30.507613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-04-08 12:01:30.507686: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-04-08 12:01:31.050536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-08 12:01:31.050583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0
2021-04-08 12:01:31.050591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N
2021-04-08 12:01:31.053409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10074 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:1a:00.0, compute capability: 7.5)
Epoch 1/30
2021-04-08 12:01:33.306344: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-04-08 12:01:33.729691: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
28/28 [==============================] - 3s 122ms/step - loss: 3.2894 - accuracy: 0.4174 - val_loss: 2.0446 - val_accuracy: 0.1892
Epoch 2/30
28/28 [==============================] - 3s 123ms/step - loss: 1.0922 - accuracy: 0.6471 - val_loss: 1.8752 - val_accuracy: 0.4685
Epoch 3/30
28/28 [==============================] - 3s 121ms/step - loss: 0.8076 - accuracy: 0.7387 - val_loss: 1.7512 - val_accuracy: 0.5135
Epoch 4/30
28/28 [==============================] - 2s 79ms/step - loss: 0.6893 - accuracy: 0.7647 - val_loss: 1.8332 - val_accuracy: 0.5586
Epoch 5/30
28/28 [==============================] - 4s 128ms/step - loss: 0.6011 - accuracy: 0.7919 - val_loss: 1.6936 - val_accuracy: 0.5586
Epoch 6/30
28/28 [==============================] - 3s 123ms/step - loss: 0.5199 - accuracy: 0.8269 - val_loss: 1.2245 - val_accuracy: 0.6036
Epoch 7/30
28/28 [==============================] - 4s 129ms/step - loss: 0.4386 - accuracy: 0.8518 - val_loss: 1.2033 - val_accuracy: 0.6577
Epoch 8/30
28/28 [==============================] - 2s 77ms/step - loss: 0.3637 - accuracy: 0.8733 - val_loss: 1.5413 - val_accuracy: 0.5766
Epoch 9/30
28/28 [==============================] - 2s 73ms/step - loss: 0.3185 - accuracy: 0.8982 - val_loss: 1.3607 - val_accuracy: 0.6577
Epoch 10/30
28/28 [==============================] - 2s 74ms/step - loss: 0.3051 - accuracy: 0.9016 - val_loss: 1.2213 - val_accuracy: 0.7027
Epoch 11/30
28/28 [==============================] - 3s 116ms/step - loss: 0.2604 - accuracy: 0.9129 - val_loss: 1.1185 - val_accuracy: 0.7297
Epoch 12/30
28/28 [==============================] - 2s 71ms/step - loss: 0.2005 - accuracy: 0.9423 - val_loss: 1.1560 - val_accuracy: 0.7297
Epoch 13/30
28/28 [==============================] - 2s 75ms/step - loss: 0.1845 - accuracy: 0.9434 - val_loss: 1.1973 - val_accuracy: 0.7207
Epoch 14/30
28/28 [==============================] - 2s 73ms/step - loss: 0.2099 - accuracy: 0.9344 - val_loss: 1.2701 - val_accuracy: 0.7027
Epoch 15/30
28/28 [==============================] - 3s 116ms/step - loss: 0.1661 - accuracy: 0.9514 - val_loss: 1.1055 - val_accuracy: 0.7387
Epoch 16/30
28/28 [==============================] - 2s 71ms/step - loss: 0.1329 - accuracy: 0.9638 - val_loss: 1.2209 - val_accuracy: 0.7297
Epoch 17/30
28/28 [==============================] - 2s 72ms/step - loss: 0.1468 - accuracy: 0.9581 - val_loss: 1.2153 - val_accuracy: 0.7117
Epoch 18/30
28/28 [==============================] - 2s 71ms/step - loss: 0.1226 - accuracy: 0.9649 - val_loss: 1.2636 - val_accuracy: 0.7297
Epoch 19/30
28/28 [==============================] - 2s 68ms/step - loss: 0.1134 - accuracy: 0.9672 - val_loss: 1.2480 - val_accuracy: 0.7297
Epoch 20/30
28/28 [==============================] - 2s 70ms/step - loss: 0.0898 - accuracy: 0.9762 - val_loss: 1.1302 - val_accuracy: 0.7568
Epoch 21/30
28/28 [==============================] - 2s 75ms/step - loss: 0.1040 - accuracy: 0.9683 - val_loss: 1.2282 - val_accuracy: 0.7748
Epoch 22/30
28/28 [==============================] - 2s 74ms/step - loss: 0.0882 - accuracy: 0.9774 - val_loss: 1.3058 - val_accuracy: 0.7748
Epoch 23/30
28/28 [==============================] - 3s 117ms/step - loss: 0.0812 - accuracy: 0.9785 - val_loss: 1.0667 - val_accuracy: 0.7568
Epoch 24/30
28/28 [==============================] - 2s 65ms/step - loss: 0.0700 - accuracy: 0.9774 - val_loss: 1.1229 - val_accuracy: 0.8108
Epoch 25/30
28/28 [==============================] - 2s 65ms/step - loss: 0.0743 - accuracy: 0.9796 - val_loss: 1.2289 - val_accuracy: 0.7297
Epoch 26/30
28/28 [==============================] - 2s 66ms/step - loss: 0.0820 - accuracy: 0.9796 - val_loss: 1.2249 - val_accuracy: 0.7838
Epoch 27/30
28/28 [==============================] - 3s 118ms/step - loss: 0.0675 - accuracy: 0.9774 - val_loss: 0.9780 - val_accuracy: 0.8378
Epoch 28/30
28/28 [==============================] - 2s 69ms/step - loss: 0.0693 - accuracy: 0.9796 - val_loss: 1.1341 - val_accuracy: 0.7387
Epoch 29/30
28/28 [==============================] - 2s 67ms/step - loss: 0.0616 - accuracy: 0.9853 - val_loss: 1.0970 - val_accuracy: 0.8018
Epoch 30/30
28/28 [==============================] - 2s 65ms/step - loss: 0.0694 - accuracy: 0.9853 - val_loss: 1.1002 - val_accuracy: 0.7928


-----------------------------------------------------------------------
第 1 次交叉验证
图片处理size用时：7.5515 s
训练一个fold用时: 79.2879 s
预测 249 个样本用时 : 1.2365 s
              precision    recall  f1-score   support

         0.0     0.7714    0.7714    0.7714        35
         1.0     0.7727    0.9444    0.8500        18
         2.0     0.6842    0.4643    0.5532        28
         3.0     0.8025    0.8553    0.8280        76
         4.0     0.8462    0.8462    0.8462        13
         5.0     0.8600    1.0000    0.9247        43
         6.0     1.0000    0.8056    0.8923        36

    accuracy                         0.8233       249
   macro avg     0.8196    0.8124    0.8094       249
weighted avg     0.8234    0.8233    0.8177       249

Epoch 1/30
28/28 [==============================] - 3s 94ms/step - loss: 1.5631 - accuracy: 0.5124 - val_loss: 2.3047 - val_accuracy: 0.3153
Epoch 2/30
28/28 [==============================] - 3s 107ms/step - loss: 0.8543 - accuracy: 0.6991 - val_loss: 1.7118 - val_accuracy: 0.5856
Epoch 3/30
28/28 [==============================] - 2s 70ms/step - loss: 0.7065 - accuracy: 0.7511 - val_loss: 1.8994 - val_accuracy: 0.3423
Epoch 4/30
28/28 [==============================] - 3s 115ms/step - loss: 0.6138 - accuracy: 0.7885 - val_loss: 1.4689 - val_accuracy: 0.5946
Epoch 5/30
28/28 [==============================] - 3s 107ms/step - loss: 0.4911 - accuracy: 0.8450 - val_loss: 0.8914 - val_accuracy: 0.7117
Epoch 6/30
28/28 [==============================] - 2s 73ms/step - loss: 0.4404 - accuracy: 0.8495 - val_loss: 0.9327 - val_accuracy: 0.6847
Epoch 7/30
28/28 [==============================] - 2s 70ms/step - loss: 0.3975 - accuracy: 0.8767 - val_loss: 1.0011 - val_accuracy: 0.7117
Epoch 8/30
28/28 [==============================] - 3s 116ms/step - loss: 0.3269 - accuracy: 0.8880 - val_loss: 0.8046 - val_accuracy: 0.7297
Epoch 9/30
28/28 [==============================] - 2s 68ms/step - loss: 0.2828 - accuracy: 0.9005 - val_loss: 0.9369 - val_accuracy: 0.7117
Epoch 10/30
28/28 [==============================] - 3s 117ms/step - loss: 0.2496 - accuracy: 0.9016 - val_loss: 0.7138 - val_accuracy: 0.7658
Epoch 11/30
28/28 [==============================] - 2s 65ms/step - loss: 0.2390 - accuracy: 0.9265 - val_loss: 0.9275 - val_accuracy: 0.7477
Epoch 12/30
28/28 [==============================] - 3s 110ms/step - loss: 0.2143 - accuracy: 0.9231 - val_loss: 0.6550 - val_accuracy: 0.8198
Epoch 13/30
28/28 [==============================] - 2s 62ms/step - loss: 0.1801 - accuracy: 0.9446 - val_loss: 0.8327 - val_accuracy: 0.7838
Epoch 14/30
28/28 [==============================] - 2s 62ms/step - loss: 0.1819 - accuracy: 0.9434 - val_loss: 0.8332 - val_accuracy: 0.7568
Epoch 15/30
28/28 [==============================] - 2s 62ms/step - loss: 0.1518 - accuracy: 0.9536 - val_loss: 0.7485 - val_accuracy: 0.7928
Epoch 16/30
28/28 [==============================] - 2s 64ms/step - loss: 0.1352 - accuracy: 0.9559 - val_loss: 0.7080 - val_accuracy: 0.7838
Epoch 17/30
28/28 [==============================] - 2s 66ms/step - loss: 0.1293 - accuracy: 0.9627 - val_loss: 0.7282 - val_accuracy: 0.7838
Epoch 18/30
28/28 [==============================] - 2s 70ms/step - loss: 0.1237 - accuracy: 0.9604 - val_loss: 0.7237 - val_accuracy: 0.8559
Epoch 19/30
28/28 [==============================] - 2s 70ms/step - loss: 0.1276 - accuracy: 0.9672 - val_loss: 0.8842 - val_accuracy: 0.7658
Epoch 20/30
28/28 [==============================] - 2s 66ms/step - loss: 0.1214 - accuracy: 0.9661 - val_loss: 0.6962 - val_accuracy: 0.7928
Epoch 21/30
28/28 [==============================] - 2s 66ms/step - loss: 0.1020 - accuracy: 0.9729 - val_loss: 0.6762 - val_accuracy: 0.8468
Epoch 22/30
28/28 [==============================] - 2s 63ms/step - loss: 0.0848 - accuracy: 0.9796 - val_loss: 0.7768 - val_accuracy: 0.8288
Epoch 23/30
28/28 [==============================] - 2s 65ms/step - loss: 0.0779 - accuracy: 0.9830 - val_loss: 0.8102 - val_accuracy: 0.8288
Epoch 24/30
28/28 [==============================] - 2s 66ms/step - loss: 0.0752 - accuracy: 0.9830 - val_loss: 0.8110 - val_accuracy: 0.8288
Epoch 25/30
28/28 [==============================] - 2s 66ms/step - loss: 0.0678 - accuracy: 0.9796 - val_loss: 0.8125 - val_accuracy: 0.8288
Epoch 26/30
28/28 [==============================] - 2s 65ms/step - loss: 0.0865 - accuracy: 0.9830 - val_loss: 0.6686 - val_accuracy: 0.8559
Epoch 27/30
28/28 [==============================] - 2s 64ms/step - loss: 0.0711 - accuracy: 0.9819 - val_loss: 0.7708 - val_accuracy: 0.8378
Epoch 28/30
28/28 [==============================] - 2s 61ms/step - loss: 0.0573 - accuracy: 0.9864 - val_loss: 0.8803 - val_accuracy: 0.8288
Epoch 29/30
28/28 [==============================] - 2s 61ms/step - loss: 0.0566 - accuracy: 0.9864 - val_loss: 0.7769 - val_accuracy: 0.8468
Epoch 30/30
28/28 [==============================] - 2s 61ms/step - loss: 0.0618 - accuracy: 0.9796 - val_loss: 0.7140 - val_accuracy: 0.8649


-----------------------------------------------------------------------
第 2 次交叉验证
图片处理size用时：7.5515 s
训练一个fold用时: 66.5509 s
预测 249 个样本用时 : 0.6619 s
              precision    recall  f1-score   support

         0.0     0.7778    0.8235    0.8000        34
         1.0     0.8333    0.8333    0.8333        18
         2.0     0.6296    0.5862    0.6071        29
         3.0     0.7831    0.8553    0.8176        76
         4.0     0.9167    0.9167    0.9167        12
         5.0     0.9111    0.9318    0.9213        44
         6.0     1.0000    0.7778    0.8750        36

    accuracy                         0.8233       249
   macro avg     0.8360    0.8178    0.8244       249
weighted avg     0.8286    0.8233    0.8232       249

Epoch 1/30
28/28 [==============================] - 3s 95ms/step - loss: 1.5915 - accuracy: 0.4932 - val_loss: 3.0075 - val_accuracy: 0.0000e+00
Epoch 2/30
28/28 [==============================] - 3s 109ms/step - loss: 0.8769 - accuracy: 0.7002 - val_loss: 2.0015 - val_accuracy: 0.1982
Epoch 3/30
28/28 [==============================] - 3s 113ms/step - loss: 0.7113 - accuracy: 0.7647 - val_loss: 1.7285 - val_accuracy: 0.3153
Epoch 4/30
28/28 [==============================] - 3s 117ms/step - loss: 0.5925 - accuracy: 0.7986 - val_loss: 1.4945 - val_accuracy: 0.4144
Epoch 5/30
28/28 [==============================] - 3s 112ms/step - loss: 0.4835 - accuracy: 0.8439 - val_loss: 1.3888 - val_accuracy: 0.4234
Epoch 6/30
28/28 [==============================] - 3s 107ms/step - loss: 0.4228 - accuracy: 0.8541 - val_loss: 1.1636 - val_accuracy: 0.6667
Epoch 7/30
28/28 [==============================] - 3s 111ms/step - loss: 0.3960 - accuracy: 0.8710 - val_loss: 1.1190 - val_accuracy: 0.7117
Epoch 8/30
28/28 [==============================] - 3s 107ms/step - loss: 0.3214 - accuracy: 0.8982 - val_loss: 0.9342 - val_accuracy: 0.7027
Epoch 9/30
28/28 [==============================] - 3s 111ms/step - loss: 0.2982 - accuracy: 0.9072 - val_loss: 0.8304 - val_accuracy: 0.7297
Epoch 10/30
28/28 [==============================] - 3s 117ms/step - loss: 0.2920 - accuracy: 0.8993 - val_loss: 0.7273 - val_accuracy: 0.7748
Epoch 11/30
28/28 [==============================] - 2s 72ms/step - loss: 0.2533 - accuracy: 0.9231 - val_loss: 0.8561 - val_accuracy: 0.7477
Epoch 12/30
28/28 [==============================] - 3s 110ms/step - loss: 0.2052 - accuracy: 0.9412 - val_loss: 0.7056 - val_accuracy: 0.8198
Epoch 13/30
28/28 [==============================] - 2s 68ms/step - loss: 0.1884 - accuracy: 0.9389 - val_loss: 0.7332 - val_accuracy: 0.8288
Epoch 14/30
28/28 [==============================] - 2s 64ms/step - loss: 0.1744 - accuracy: 0.9480 - val_loss: 0.7384 - val_accuracy: 0.7658
Epoch 15/30
28/28 [==============================] - 3s 103ms/step - loss: 0.1484 - accuracy: 0.9593 - val_loss: 0.6528 - val_accuracy: 0.7748
Epoch 16/30
28/28 [==============================] - 2s 62ms/step - loss: 0.1413 - accuracy: 0.9672 - val_loss: 0.6631 - val_accuracy: 0.7658
Epoch 17/30
28/28 [==============================] - 3s 106ms/step - loss: 0.1435 - accuracy: 0.9604 - val_loss: 0.5380 - val_accuracy: 0.8468
Epoch 18/30
28/28 [==============================] - 2s 63ms/step - loss: 0.1348 - accuracy: 0.9525 - val_loss: 0.6867 - val_accuracy: 0.7748
Epoch 19/30
28/28 [==============================] - 2s 64ms/step - loss: 0.1235 - accuracy: 0.9695 - val_loss: 0.5413 - val_accuracy: 0.8559
Epoch 20/30
28/28 [==============================] - 2s 66ms/step - loss: 0.1115 - accuracy: 0.9661 - val_loss: 0.6546 - val_accuracy: 0.8468
Epoch 21/30
28/28 [==============================] - 2s 68ms/step - loss: 0.1144 - accuracy: 0.9638 - val_loss: 0.5954 - val_accuracy: 0.8559
Epoch 22/30
28/28 [==============================] - 2s 70ms/step - loss: 0.0978 - accuracy: 0.9740 - val_loss: 0.6501 - val_accuracy: 0.8468
Epoch 23/30
28/28 [==============================] - 2s 69ms/step - loss: 0.0859 - accuracy: 0.9751 - val_loss: 0.6996 - val_accuracy: 0.8559
Epoch 24/30
28/28 [==============================] - 2s 67ms/step - loss: 0.0887 - accuracy: 0.9774 - val_loss: 0.5736 - val_accuracy: 0.8559
Epoch 25/30
28/28 [==============================] - 2s 67ms/step - loss: 0.0998 - accuracy: 0.9717 - val_loss: 0.5694 - val_accuracy: 0.8468
Epoch 26/30
28/28 [==============================] - 2s 66ms/step - loss: 0.0778 - accuracy: 0.9796 - val_loss: 0.6921 - val_accuracy: 0.7748
Epoch 27/30
28/28 [==============================] - 2s 66ms/step - loss: 0.0762 - accuracy: 0.9796 - val_loss: 0.6632 - val_accuracy: 0.8468
Epoch 28/30
28/28 [==============================] - 2s 64ms/step - loss: 0.0691 - accuracy: 0.9830 - val_loss: 0.6302 - val_accuracy: 0.8649
Epoch 29/30
28/28 [==============================] - 2s 64ms/step - loss: 0.0724 - accuracy: 0.9796 - val_loss: 0.6888 - val_accuracy: 0.8378
Epoch 30/30
28/28 [==============================] - 2s 67ms/step - loss: 0.0730 - accuracy: 0.9762 - val_loss: 0.6176 - val_accuracy: 0.8468


-----------------------------------------------------------------------
第 3 次交叉验证
图片处理size用时：7.5515 s
训练一个fold用时: 74.3934 s
预测 249 个样本用时 : 0.6698 s
              precision    recall  f1-score   support

         0.0     0.8235    0.8235    0.8235        34
         1.0     0.8667    0.7222    0.7879        18
         2.0     0.7097    0.7586    0.7333        29
         3.0     0.8353    0.9467    0.8875        75
         4.0     1.0000    0.8462    0.9167        13
         5.0     0.9767    0.9545    0.9655        44
         6.0     1.0000    0.8333    0.9091        36

    accuracy                         0.8715       249
   macro avg     0.8874    0.8407    0.8605       249
weighted avg     0.8787    0.8715    0.8720       249

Epoch 1/30
28/28 [==============================] - 3s 95ms/step - loss: 1.5178 - accuracy: 0.5283 - val_loss: 2.4485 - val_accuracy: 0.0000e+00
Epoch 2/30
28/28 [==============================] - 3s 114ms/step - loss: 0.7382 - accuracy: 0.7285 - val_loss: 1.9199 - val_accuracy: 0.2793
Epoch 3/30
28/28 [==============================] - 3s 111ms/step - loss: 0.5522 - accuracy: 0.8111 - val_loss: 1.3708 - val_accuracy: 0.6757
Epoch 4/30
28/28 [==============================] - 3s 118ms/step - loss: 0.4665 - accuracy: 0.8405 - val_loss: 1.2754 - val_accuracy: 0.7117
Epoch 5/30
28/28 [==============================] - 3s 112ms/step - loss: 0.4073 - accuracy: 0.8699 - val_loss: 0.9733 - val_accuracy: 0.7297
Epoch 6/30
28/28 [==============================] - 2s 63ms/step - loss: 0.3135 - accuracy: 0.8925 - val_loss: 0.9946 - val_accuracy: 0.7748
Epoch 7/30
28/28 [==============================] - 3s 109ms/step - loss: 0.2622 - accuracy: 0.9253 - val_loss: 0.8289 - val_accuracy: 0.8108
Epoch 8/30
28/28 [==============================] - 2s 63ms/step - loss: 0.2378 - accuracy: 0.9231 - val_loss: 0.9334 - val_accuracy: 0.7568
Epoch 9/30
28/28 [==============================] - 2s 62ms/step - loss: 0.2040 - accuracy: 0.9299 - val_loss: 0.9975 - val_accuracy: 0.7568
Epoch 10/30
28/28 [==============================] - 2s 62ms/step - loss: 0.1811 - accuracy: 0.9434 - val_loss: 0.8530 - val_accuracy: 0.8198
Epoch 11/30
28/28 [==============================] - 3s 111ms/step - loss: 0.1745 - accuracy: 0.9400 - val_loss: 0.7983 - val_accuracy: 0.8108
Epoch 12/30
28/28 [==============================] - 2s 66ms/step - loss: 0.1620 - accuracy: 0.9491 - val_loss: 0.8126 - val_accuracy: 0.8018
Epoch 13/30
28/28 [==============================] - 2s 71ms/step - loss: 0.1489 - accuracy: 0.9581 - val_loss: 0.8040 - val_accuracy: 0.7838
Epoch 14/30
28/28 [==============================] - 2s 67ms/step - loss: 0.1371 - accuracy: 0.9581 - val_loss: 0.8244 - val_accuracy: 0.7928
Epoch 15/30
28/28 [==============================] - 2s 64ms/step - loss: 0.1164 - accuracy: 0.9604 - val_loss: 0.8413 - val_accuracy: 0.7748
Epoch 16/30
28/28 [==============================] - 3s 107ms/step - loss: 0.1116 - accuracy: 0.9615 - val_loss: 0.7165 - val_accuracy: 0.8018
Epoch 17/30
28/28 [==============================] - 2s 63ms/step - loss: 0.1100 - accuracy: 0.9661 - val_loss: 0.7578 - val_accuracy: 0.7838
Epoch 18/30
28/28 [==============================] - 2s 65ms/step - loss: 0.0927 - accuracy: 0.9762 - val_loss: 0.8244 - val_accuracy: 0.7748
Epoch 19/30
28/28 [==============================] - 2s 64ms/step - loss: 0.0858 - accuracy: 0.9729 - val_loss: 0.9222 - val_accuracy: 0.7838
Epoch 20/30
28/28 [==============================] - 2s 65ms/step - loss: 0.0929 - accuracy: 0.9706 - val_loss: 0.7671 - val_accuracy: 0.8108
Epoch 21/30
28/28 [==============================] - 2s 65ms/step - loss: 0.0755 - accuracy: 0.9774 - val_loss: 0.8676 - val_accuracy: 0.8198
Epoch 22/30
28/28 [==============================] - 2s 65ms/step - loss: 0.0768 - accuracy: 0.9785 - val_loss: 0.7267 - val_accuracy: 0.8198
Epoch 23/30
28/28 [==============================] - 2s 63ms/step - loss: 0.0689 - accuracy: 0.9785 - val_loss: 0.8212 - val_accuracy: 0.8018
Epoch 24/30
28/28 [==============================] - 2s 62ms/step - loss: 0.0531 - accuracy: 0.9864 - val_loss: 0.9549 - val_accuracy: 0.7838
Epoch 25/30
28/28 [==============================] - 2s 63ms/step - loss: 0.0831 - accuracy: 0.9717 - val_loss: 0.8502 - val_accuracy: 0.8288
Epoch 26/30
28/28 [==============================] - 2s 64ms/step - loss: 0.0562 - accuracy: 0.9774 - val_loss: 0.9153 - val_accuracy: 0.8198
Epoch 27/30
28/28 [==============================] - 2s 62ms/step - loss: 0.0552 - accuracy: 0.9808 - val_loss: 0.8286 - val_accuracy: 0.8198
Epoch 28/30
28/28 [==============================] - 2s 61ms/step - loss: 0.0533 - accuracy: 0.9830 - val_loss: 0.8167 - val_accuracy: 0.7838
Epoch 29/30
28/28 [==============================] - 2s 62ms/step - loss: 0.0547 - accuracy: 0.9887 - val_loss: 0.9403 - val_accuracy: 0.7838
Epoch 30/30
28/28 [==============================] - 2s 62ms/step - loss: 0.0524 - accuracy: 0.9808 - val_loss: 0.8185 - val_accuracy: 0.8288


-----------------------------------------------------------------------
第 4 次交叉验证
图片处理size用时：7.5515 s
训练一个fold用时: 66.8043 s
预测 249 个样本用时 : 0.6349 s
              precision    recall  f1-score   support

         0.0     0.8710    0.7941    0.8308        34
         1.0     0.8125    0.7222    0.7647        18
         2.0     0.6897    0.6897    0.6897        29
         3.0     0.8875    0.9467    0.9161        75
         4.0     0.8462    0.8462    0.8462        13
         5.0     0.8269    0.9773    0.8958        44
         6.0     0.9643    0.7500    0.8437        36

    accuracy                         0.8514       249
   macro avg     0.8426    0.8180    0.8267       249
weighted avg     0.8550    0.8514    0.8494       249

Epoch 1/30
28/28 [==============================] - 3s 110ms/step - loss: 1.4103 - accuracy: 0.5548 - val_loss: 2.3516 - val_accuracy: 0.1351
Epoch 2/30
28/28 [==============================] - 3s 111ms/step - loss: 0.6841 - accuracy: 0.7695 - val_loss: 1.6643 - val_accuracy: 0.3423
Epoch 3/30
28/28 [==============================] - 3s 110ms/step - loss: 0.5344 - accuracy: 0.8169 - val_loss: 1.3266 - val_accuracy: 0.5856
Epoch 4/30
28/28 [==============================] - 3s 114ms/step - loss: 0.4029 - accuracy: 0.8565 - val_loss: 1.0204 - val_accuracy: 0.6937
Epoch 5/30
28/28 [==============================] - 2s 72ms/step - loss: 0.3708 - accuracy: 0.8780 - val_loss: 1.0481 - val_accuracy: 0.7207
Epoch 6/30
28/28 [==============================] - 3s 108ms/step - loss: 0.3010 - accuracy: 0.8949 - val_loss: 0.8891 - val_accuracy: 0.7117
Epoch 7/30
28/28 [==============================] - 3s 109ms/step - loss: 0.2478 - accuracy: 0.9209 - val_loss: 0.8436 - val_accuracy: 0.7297
Epoch 8/30
28/28 [==============================] - 3s 109ms/step - loss: 0.2287 - accuracy: 0.9266 - val_loss: 0.8343 - val_accuracy: 0.7297
Epoch 9/30
28/28 [==============================] - 2s 63ms/step - loss: 0.1970 - accuracy: 0.9390 - val_loss: 0.8692 - val_accuracy: 0.7297
Epoch 10/30
28/28 [==============================] - 3s 108ms/step - loss: 0.1780 - accuracy: 0.9480 - val_loss: 0.7756 - val_accuracy: 0.8288
Epoch 11/30
28/28 [==============================] - 3s 107ms/step - loss: 0.1599 - accuracy: 0.9412 - val_loss: 0.7751 - val_accuracy: 0.7748
Epoch 12/30
28/28 [==============================] - 3s 107ms/step - loss: 0.1649 - accuracy: 0.9492 - val_loss: 0.7537 - val_accuracy: 0.8018
Epoch 13/30
28/28 [==============================] - 3s 109ms/step - loss: 0.1398 - accuracy: 0.9537 - val_loss: 0.7221 - val_accuracy: 0.8378
Epoch 14/30
28/28 [==============================] - 2s 71ms/step - loss: 0.1299 - accuracy: 0.9661 - val_loss: 0.7826 - val_accuracy: 0.8018
Epoch 15/30
28/28 [==============================] - 3s 116ms/step - loss: 0.1188 - accuracy: 0.9548 - val_loss: 0.7061 - val_accuracy: 0.8378
Epoch 16/30
28/28 [==============================] - 2s 70ms/step - loss: 0.1031 - accuracy: 0.9661 - val_loss: 0.8199 - val_accuracy: 0.7838
Epoch 17/30
28/28 [==============================] - 3s 110ms/step - loss: 0.1171 - accuracy: 0.9605 - val_loss: 0.6800 - val_accuracy: 0.8739
Epoch 18/30
28/28 [==============================] - 3s 109ms/step - loss: 0.1131 - accuracy: 0.9661 - val_loss: 0.6704 - val_accuracy: 0.8288
Epoch 19/30
28/28 [==============================] - 3s 110ms/step - loss: 0.1038 - accuracy: 0.9695 - val_loss: 0.6581 - val_accuracy: 0.8288
Epoch 20/30
28/28 [==============================] - 3s 109ms/step - loss: 0.0990 - accuracy: 0.9695 - val_loss: 0.5958 - val_accuracy: 0.8559
Epoch 21/30
28/28 [==============================] - 2s 63ms/step - loss: 0.0820 - accuracy: 0.9763 - val_loss: 0.8085 - val_accuracy: 0.8649
Epoch 22/30
28/28 [==============================] - 2s 64ms/step - loss: 0.0754 - accuracy: 0.9774 - val_loss: 0.6954 - val_accuracy: 0.8559
Epoch 23/30
28/28 [==============================] - 2s 65ms/step - loss: 0.0663 - accuracy: 0.9797 - val_loss: 0.6947 - val_accuracy: 0.8559
Epoch 24/30
28/28 [==============================] - 2s 64ms/step - loss: 0.0705 - accuracy: 0.9797 - val_loss: 0.6502 - val_accuracy: 0.8649
Epoch 25/30
28/28 [==============================] - 3s 108ms/step - loss: 0.0737 - accuracy: 0.9763 - val_loss: 0.5814 - val_accuracy: 0.8829
Epoch 26/30
28/28 [==============================] - 2s 63ms/step - loss: 0.0701 - accuracy: 0.9819 - val_loss: 0.6380 - val_accuracy: 0.8829
Epoch 27/30
28/28 [==============================] - 2s 62ms/step - loss: 0.0610 - accuracy: 0.9808 - val_loss: 0.6237 - val_accuracy: 0.8919
Epoch 28/30
28/28 [==============================] - 2s 62ms/step - loss: 0.0651 - accuracy: 0.9808 - val_loss: 0.6564 - val_accuracy: 0.8739
Epoch 29/30
28/28 [==============================] - 2s 62ms/step - loss: 0.0569 - accuracy: 0.9842 - val_loss: 0.6075 - val_accuracy: 0.8559
Epoch 30/30
28/28 [==============================] - 2s 62ms/step - loss: 0.0741 - accuracy: 0.9740 - val_loss: 0.6315 - val_accuracy: 0.8559


-----------------------------------------------------------------------
第 5 次交叉验证
图片处理size用时：7.5515 s
训练一个fold用时: 78.4995 s
预测 248 个样本用时 : 1.0499 s
              precision    recall  f1-score   support

         0.0     0.7073    0.8529    0.7733        34
         1.0     0.8333    0.8333    0.8333        18
         2.0     0.8333    0.7143    0.7692        28
         3.0     0.9494    0.9868    0.9677        76
         4.0     1.0000    0.8462    0.9167        13
         5.0     0.9070    0.9070    0.9070        43
         6.0     1.0000    0.8889    0.9412        36

    accuracy                         0.8911       248
   macro avg     0.8900    0.8613    0.8726       248
weighted avg     0.8973    0.8911    0.8919       248





before总的混淆矩阵：
171	139
90		73
143			92
378				347
64					55
218						208
180							146
1244	177	89	130	408	60	233	147


P_1	0.7853	R_1	0.8128	F_1	0.7988
P_2	0.8202	R_2	0.8111	F_2	0.8156
P_3	0.7077	R_3	0.6434	F_3	0.6740
P_4	0.8505	R_4	0.9180	F_4	0.8830
P_5	0.9167	R_5	0.8594	F_5	0.8871
P_6	0.8927	R_6	0.9541	F_6	0.9224
P_7	0.9932	R_7	0.8111	F_7	0.8930

P	0.8523	R	0.8300	F	0.8391

A	0.8521

